#!/bin/sh

readonly STYLESHEET="$HOME/.pandoc/github.css"

usage(){
cat <<-EOF
	markdown previewer
	usage: mdp <filename> [keep temp]
EOF

exit 1
}


main(){
	[ "$*" == '' ] && usage

	local filename=$1; shift
	local keep=$1; shift

	local base="$(basename $filename .md)"
#local hash="$(echo "$(gdate +%s%N) $base" | gsha1sum | cut -c -8)"
#	local hash="$(echo "$base" | gsha1sum | cut -c -8)"
	local outfile="$base.pdf"

	(pandoc "$filename"  \
		-o "$outfile"   \
		-c "$STYLESHEET" \
		--number-sections \
		--latex-engine=xelatex \
			&& open "$outfile" \
			&& open -a 'iTerm')&

#		if [ "$keep" = '' ]; then
#			read -p "Refresh $outfile with any key" -n 1 -s
#			echo
#		fi
}

main $*
