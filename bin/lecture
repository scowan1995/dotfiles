#!/bin/bash
alias ls='ls --color=none'

readonly MODULE_INFO='../module.json'

if [ ! -f "$MODULE_INFO" ]; then
	echo 'No module information found. Stop.'
	exit 1
fi


date="$(date '+%Y-%m-%d, %H:%M')"

read -p  'Location: ' location
read -rp 'Topic: ' topic
read -p  'Lecture Number: ' number

note_file="./$(echo "$number")_$(echo "$topic" | tr ' [:upper:]' '_[:lower:]').md"

instructor="$(jq -r '"\(.instructor.name) ([\(.instructor.email)](mailto:\(.instructor.email)))"' < $MODULE_INFO)"
code="$(jq -r '.module.code' < $MODULE_INFO)"
title="$(jq -r '.module.title' < $MODULE_INFO)"
homepage="$(jq -r '.module.homepage' < $MODULE_INFO)"

note_init(){
	cat <<- EOF
	# $topic  
	> [$code: *$title*]($homepage)  
	> $instructor  
	> $location  
	> $date  


EOF
}


note_init > "$note_file"
vim + "$note_file"
